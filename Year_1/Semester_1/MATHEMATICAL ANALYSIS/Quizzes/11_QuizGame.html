<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz Game - Indefinite Integrals</title>
    <!-- MathJax Configuration -->
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <style>
        /* Overall Theme & Backgrounds */
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            background-color: #363530; /* Dark grey page background */
            color: #f0f2f5; /* Light text for readability */
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
            box-sizing: border-box;
        }

        /* Containers Styling */
        .quiz-container {
            background-color: #857c7c; /* Lighter muted grey container */
            border-radius: 12px;
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.4);
            width: 100%;
            max-width: 800px;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        /* Header with Gradient */
        .quiz-header {
            background-image: linear-gradient(45deg, #4f46e5, #7c3aed); /* Blue -> Purple gradient */
            color: white;
            padding: 24px;
            text-align: center;
        }
        .quiz-header h1 {
            margin: 0;
            font-size: 1.8em;
        }

        /* Main Quiz Body */
        .quiz-body {
            padding: 24px;
        }
        #question-container {
            margin-bottom: 20px;
        }
        #question-text {
            font-size: 1.4em;
            font-weight: 600;
            margin-bottom: 20px;
            line-height: 1.5;
        }

        /* Options Grid & Buttons */
        .options-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 12px;
        }
        .option-btn {
            width: 100%;
            padding: 15px;
            font-size: 1.1em;
            text-align: left;
            color: #f0f2f5;
            background-color: #6b6464; /* Darker grey for options */
            border: 1px solid #9e9696;
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.2s, border-color 0.2s;
        }
        .option-btn:hover:not(:disabled) {
            background-color: #7d7575;
            border-color: #b1a8a8;
        }

        /* Button Feedback Colors */
        .option-btn.correct {
            background-color: #10b981; /* Bright green for correct */
            border-color: #0f9a6d;
            color: white;
        }
        .option-btn.incorrect {
            background-color: #ef4444; /* Bright red for incorrect */
            border-color: #d83a3a;
            color: white;
        }
        .option-btn:disabled {
            cursor: not-allowed;
            opacity: 0.9;
        }

        /* Explanation/Feedback Box */
        #feedback-container {
            margin-top: 20px;
        }
        #explanation {
            display: none;
            padding: 15px;
            border-radius: 8px;
            font-size: 1.1em;
            line-height: 1.6;
            background-color: #4a4843; /* Darker background for explanation */
            border: 1px solid #6b6464;
        }

        /* Footer and Navigation */
        .quiz-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 24px;
            background-color: #857c7c; /* Lighter muted grey footer */
            border-top: 1px solid #9e9696;
        }
        #progress-text {
            font-size: 1em;
            color: #d1d5db; /* Lighter grey for secondary text */
        }
        .nav-btn {
            padding: 12px 24px;
            font-size: 1em;
            font-weight: bold;
            color: white;
            background-color: #4f46e5; /* Vibrant blue for actions */
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        .nav-btn:hover:not(:disabled) {
            background-color: #4338ca;
        }
        .nav-btn:disabled {
            background-color: #52504b;
            cursor: not-allowed;
        }
        #navigation-buttons {
            display: flex;
            gap: 10px;
        }
        
        /* Results Screen */
        #results-container {
            text-align: center;
            padding: 40px 24px;
        }
        #results-container h2 {
            font-size: 2em;
            margin-bottom: 20px;
        }
        #score-text {
            font-size: 1.5em;
            margin-bottom: 30px;
        }
        #restart-btn {
            padding: 15px 30px;
            font-size: 1.2em;
            font-weight: bold;
            color: white;
            background-color: #4f46e5; /* Vibrant blue for actions */
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        #restart-btn:hover {
            background-color: #4338ca;
        }
    </style>
</head>
<body>
    <div class="quiz-container">
        <div class="quiz-header">
            <h1>Quiz Game: Indefinite Integrals</h1>
        </div>
        <div class="quiz-body">
            <div id="question-container" style="display: none;">
                <p id="question-text"></p>
                <div id="options-grid" class="options-grid"></div>
                <div id="feedback-container">
                    <div id="explanation"></div>
                </div>
            </div>
            <div id="results-container" style="display: none;">
                <h2>Quiz Complete!</h2>
                <p id="score-text"></p>
                <button id="restart-btn" class="nav-btn">Restart Quiz</button>
            </div>
        </div>
        <div class="quiz-footer" style="display: none;">
            <p id="progress-text"></p>
            <div id="navigation-buttons">
                <button id="prev-btn" class="nav-btn">Previous</button>
                <button id="next-btn" class="nav-btn">Next</button>
            </div>
        </div>
    </div>

    <script>
        const questions = [
            { question: "What is an antiderivative of a function \\(f(x)\\)?", options: ["A function \\(F(x)\\) such that \\(F(x) = f'(x)\\).", "A function \\(F(x)\\) such that \\(F'(x) = f(x)\\).", "The area under the curve of \\(f(x)\\).", "The slope of the tangent line to \\(f(x)\\)."], correct: 1, explanation: "A function \\(F(x)\\) is an antiderivative of \\(f(x)\\) if the derivative of \\(F(x)\\) is \\(f(x)\\). This is the fundamental definition of the reverse process of differentiation." },
            { question: "If \\(F(x)\\) is an antiderivative of \\(f(x)\\), which of the following is also an antiderivative of \\(f(x)\\)?", options: ["\\(F(x) + C\\), where \\(C\\) is any constant.", "\\(C \\cdot F(x)\\), where \\(C\\) is any constant.", "\\(F(x+C)\\), where \\(C\\) is any constant.", "Only \\(F(x)\\) is an antiderivative."], correct: 0, explanation: "The derivative of any constant \\(C\\) is zero. Therefore, \\((F(x) + C)' = F'(x) + 0 = f(x)\\). This means there is an infinite family of antiderivatives for any function, all differing by a constant. This constant is called the constant of integration." },
            { question: "What is the indefinite integral \\(\\int 3x^2 \\,dx\\)?", options: ["\\(6x + C\\)", "\\(x^3 + C\\)", "\\(\\frac{3}{2}x^3 + C\\)", "\\(3x^2 + C\\)"], correct: 1, explanation: "Using the power rule for integration, \\(\\int x^n \\,dx = \\frac{x^{n+1}}{n+1} + C\\). Here, \\(n=2\\), so \\(\\int 3x^2 \\,dx = 3 \\cdot \\frac{x^{2+1}}{2+1} + C = 3 \\cdot \\frac{x^3}{3} + C = x^3 + C\\)." },
            { question: "Which property allows us to write \\(\\int (f(x) + g(x)) \\,dx\\) as \\(\\int f(x) \\,dx + \\int g(x) \\,dx\\)?", options: ["The product rule of integration.", "The chain rule of integration.", "The linearity property of integrals.", "The substitution method."], correct: 2, explanation: "The linearity property states that the integral of a sum of functions is the sum of their integrals. This is a direct consequence of the linearity of the derivative operator." },
            { question: "Calculate the integral \\(\\int (\\cos(x) - e^x) \\,dx\\).", options: ["\\(\\sin(x) - e^x + C\\)", "\\(-\\sin(x) - e^x + C\\)", "\\(\\sin(x) - \\ln(x) + C\\)", "\\(\\cos(x) - e^x + C\\)"], correct: 0, explanation: "We integrate term by term. The integral of \\(\\cos(x)\\) is \\(\\sin(x)\\), and the integral of \\(e^x\\) is \\(e^x\\). Therefore, \\(\\int (\\cos(x) - e^x) \\,dx = \\sin(x) - e^x + C\\)." },
            { question: "The method of integration by parts is derived from which differentiation rule?", options: ["The Chain Rule", "The Quotient Rule", "The Power Rule", "The Product Rule"], correct: 3, explanation: "The product rule for differentiation is \\((uv)' = u'v + uv'\\). Integrating both sides gives \\(uv = \\int u'v \\,dx + \\int uv' \\,dx\\). Rearranging this yields the integration by parts formula: \\(\\int uv' \\,dx = uv - \\int u'v \\,dx\\)." },
            { question: "Using integration by parts, what is \\(\\int x e^x \\,dx\\)?", options: ["\\(e^x + C\\)", "\\(x e^x - e^x + C\\)", "\\(\\frac{1}{2}x^2 e^x + C\\)", "\\(x e^x + C\\)"], correct: 1, explanation: "Let \\(u=x\\) and \\(dv=e^x \\,dx\\). Then \\(du=dx\\) and \\(v=e^x\\). Using the formula \\(\\int u \\,dv = uv - \\int v \\,du\\), we get \\(x e^x - \\int e^x \\,dx = x e^x - e^x + C\\)." },
            { question: "The method of integration by substitution is the reverse of which differentiation rule?", options: ["The Product Rule", "The Chain Rule", "The Quotient Rule", "The Constant Multiple Rule"], correct: 1, explanation: "Integration by substitution is used for integrals of the form \\(\\int f(g(x))g'(x) \\,dx\\). This form is the result of applying the chain rule to differentiate a composite function. The substitution \\(u=g(x)\\) reverses this process." },
            { question: "To solve \\(\\int 2x \\sqrt{x^2+1} \\,dx\\), what is the most appropriate substitution?", options: ["\\(u = 2x\\)", "\\(u = x^2\\)", "\\(u = x^2+1\\)", "\\(u = \\sqrt{x}\\)"], correct: 2, explanation: "Let \\(u = x^2+1\\). Then the differential is \\(du = 2x \\,dx\\). This perfectly replaces the remaining parts of the integrand, transforming the integral into the much simpler \\(\\int \\sqrt{u} \\,du\\)." },
            { question: "Calculate \\(\\int \\frac{1}{x} \\,dx\\).", options: ["\\(\\ln|x| + C\\)", "\\(\\frac{1}{x^2} + C\\)", "\\(1 + C\\)", "\\(- \\frac{1}{x^2} + C\\)"], correct: 0, explanation: "The derivative of \\(\\ln(x)\\) is \\(1/x\\). We use the absolute value, \\(\\ln|x|\\), because the domain of \\(1/x\\) includes negative numbers, while the domain of \\(\\ln(x)\\) is only positive numbers." },
            { question: "What is the integral \\(\\int \\sin(3x) \\,dx\\)?", options: ["\\(\\cos(3x) + C\\)", "\\(3\\cos(3x) + C\\)", "\\(-\\frac{1}{3}\\cos(3x) + C\\)", "\\(-3\\cos(3x) + C\\)"], correct: 2, explanation: "Use substitution with \\(u=3x\\), so \\(du=3\\,dx\\), or \\(dx = du/3\\). The integral becomes \\(\\int \\sin(u) \\frac{du}{3} = \\frac{1}{3} \\int \\sin(u) \\,du = -\\frac{1}{3}\\cos(u) + C = -\\frac{1}{3}\\cos(3x) + C\\)." },
            { question: "Find the integral \\(\\int \\frac{e^x}{e^x+1} \\,dx\\).", options: ["\\(\\ln|e^x+1| + C\\)", "\\(\\frac{e^x}{(e^x+1)^2} + C\\)", "\\(e^x \\ln|e^x+1| + C\\)", "\\(\\arctan(e^x) + C\\)"], correct: 0, explanation: "Use substitution with \\(u = e^x+1\\). Then \\(du = e^x \\,dx\\). The integral becomes \\(\\int \\frac{1}{u} \\,du = \\ln|u| + C\\). Substituting back gives \\(\\ln|e^x+1| + C\\)." },
            { question: "What is the result of \\(\\int \\frac{x^2+x+1}{x} \\,dx\\)?", options: ["\\(\\frac{x^3/3 + x^2/2 + x}{x^2/2} + C\\)", "\\(\\frac{1}{2}x^2 + x + \\ln|x| + C\\)", "\\(x+1 + C\\)", "\\(\\ln|x^2+x+1| + C\\)"], correct: 1, explanation: "First, simplify the integrand by dividing each term by \\(x\\): \\(\\frac{x^2}{x} + \\frac{x}{x} + \\frac{1}{x} = x + 1 + \\frac{1}{x}\\). Now integrate term by term: \\(\\int (x + 1 + \\frac{1}{x}) \\,dx = \\frac{x^2}{2} + x + \\ln|x| + C\\)." },
            { question: "To calculate \\(\\int x \\sin(x) \\,dx\\) using integration by parts, what is a good choice for \\(u\\) and \\(dv\\)?", options: ["\\(u = \\sin(x)\\), \\(dv = x \\,dx\\)", "\\(u = x \\sin(x)\\), \\(dv = dx\\)", "\\(u = x\\), \\(dv = \\sin(x) \\,dx\\)", "This cannot be solved by parts."], correct: 2, explanation: "Let \\(u=x\\) and \\(dv=\\sin(x)\\,dx\\). This is a good choice because the derivative of \\(u\\) is \\(du=dx\\) (simpler), and the integral of \\(dv\\) is \\(v=-\\cos(x)\\) (not more complex). The alternative, \\(u=\\sin(x)\\), would lead to a more complicated integral." },
            { question: "Following the previous question, what is the result of \\(\\int x \\sin(x) \\,dx\\)?", options: ["\\(-x \\cos(x) + \\sin(x) + C\\)", "\\(x \\cos(x) - \\sin(x) + C\\)", "\\(\\frac{1}{2}x^2 \\cos(x) + C\\)", "\\(-x \\cos(x) - \\sin(x) + C\\)"], correct: 0, explanation: "With \\(u=x\\) and \\(dv=\\sin(x)\\,dx\\), we have \\(du=dx\\) and \\(v=-\\cos(x)\\). The formula gives \\(uv - \\int v \\,du = x(-\\cos(x)) - \\int (-\\cos(x)) \\,dx = -x \\cos(x) + \\int \\cos(x) \\,dx = -x \\cos(x) + \\sin(x) + C\\)." },
            { question: "What is the indefinite integral of \\(f(x) = \\frac{1}{1+x^2}\\)?", options: ["\\(\\ln(1+x^2) + C\\)", "\\(\\arctan(x) + C\\)", "\\(\\frac{-2x}{(1+x^2)^2} + C\\)", "\\(\\arcsin(x) + C\\)"], correct: 1, explanation: "This is a standard integral form. The derivative of \\(\\arctan(x)\\) is \\(\\frac{1}{1+x^2}\\), so the indefinite integral is \\(\\arctan(x) + C\\)." },
            { question: "Calculate \\(\\int \\ln(x) \\,dx\\). (Hint: Use integration by parts with \\(u=\\ln(x)\\)).", options: ["\\(\\frac{1}{x} + C\\)", "\\(x \\ln(x) - x + C\\)", "\\(\\frac{(\\ln(x))^2}{2} + C\\)", "\\(x \\ln(x) + x + C\\)"], correct: 1, explanation: "Let \\(u=\\ln(x)\\) and \\(dv=dx\\). Then \\(du = \\frac{1}{x}dx\\) and \\(v=x\\). Using integration by parts: \\(uv - \\int v \\,du = \\ln(x) \\cdot x - \\int x \\cdot \\frac{1}{x} \\,dx = x\\ln(x) - \\int 1 \\,dx = x\\ln(x) - x + C\\)." },
            { question: "The expression \\(\\int f(x) \\,dx\\) represents:", options: ["A single function.", "A specific numerical value.", "A family of functions.", "The derivative of \\(f(x)\\)."], correct: 2, explanation: "The indefinite integral represents a family of functions, where each function is an antiderivative of \\(f(x)\\). They all differ by a constant value, \\(C\\)." },
            { question: "Find the integral \\(\\int (x-1)^2 \\,dx\\).", options: ["\\(\\frac{(x-1)^3}{3} + C\\)", "\\(2(x-1) + C\\)", "\\(\\frac{1}{2}x^2 - x + C\\)", "\\((x-1)^3 + C\\)"], correct: 0, explanation: "You can use substitution with \\(u=x-1\\), so \\(du=dx\\). The integral becomes \\(\\int u^2 \\,du = \\frac{u^3}{3} + C = \\frac{(x-1)^3}{3} + C\\). Alternatively, you can expand \\((x-1)^2 = x^2 - 2x + 1\\) and integrate term by term." },
            { question: "What is the process of finding an indefinite integral called?", options: ["Differentiation", "Integration or Antidifferentiation", "Limit evaluation", "Function composition"], correct: 1, explanation: "The process of finding the family of antiderivatives for a function is known as integration or, more specifically, antidifferentiation." }
        ];

        const questionContainer = document.getElementById('question-container');
        const questionText = document.getElementById('question-text');
        const optionsGrid = document.getElementById('options-grid');
        const explanation = document.getElementById('explanation');
        const prevBtn = document.getElementById('prev-btn');
        const nextBtn = document.getElementById('next-btn');
        const progressText = document.getElementById('progress-text');
        const resultsContainer = document.getElementById('results-container');
        const scoreText = document.getElementById('score-text');
        const restartBtn = document.getElementById('restart-btn');
        const quizFooter = document.querySelector('.quiz-footer');

        let currentQuestionIndex = 0;
        let userAnswers = [];

        function startQuiz() {
            currentQuestionIndex = 0;
            userAnswers = new Array(questions.length).fill(null);
            resultsContainer.style.display = 'none';
            questionContainer.style.display = 'block';
            quizFooter.style.display = 'flex';
            showQuestion();
        }

        function showQuestion() {
            resetState();
            const question = questions[currentQuestionIndex];
            questionText.innerHTML = question.question;
            
            question.options.forEach((option, index) => {
                const button = document.createElement('button');
                button.innerHTML = option;
                button.classList.add('option-btn');
                button.dataset.index = index;
                button.addEventListener('click', selectAnswer);
                optionsGrid.appendChild(button);
            });
            
            updateNavigation();
            restoreAnswerState();
            MathJax.typesetPromise();
        }
        
        function resetState() {
            while (optionsGrid.firstChild) {
                optionsGrid.removeChild(optionsGrid.firstChild);
            }
            explanation.style.display = 'none';
        }

        function updateNavigation() {
            progressText.innerText = `Question ${currentQuestionIndex + 1} of ${questions.length}`;
            prevBtn.disabled = currentQuestionIndex === 0;
            nextBtn.innerText = currentQuestionIndex === questions.length - 1 ? 'Finish' : 'Next';
        }

        function restoreAnswerState() {
            const userAnswer = userAnswers[currentQuestionIndex];
            if (userAnswer !== null) {
                showFeedback(userAnswer);
            }
        }

        function selectAnswer(e) {
            const selectedIndex = parseInt(e.target.dataset.index);
            if (userAnswers[currentQuestionIndex] === null) { // Only process if it's the first time answering
                userAnswers[currentQuestionIndex] = selectedIndex;
                showFeedback(selectedIndex);
            }
        }

        function showFeedback(selectedIndex) {
            const correctIndex = questions[currentQuestionIndex].correct;
            
            Array.from(optionsGrid.children).forEach((button, index) => {
                if (index === correctIndex) {
                    button.classList.add('correct');
                } else if (index === selectedIndex) {
                    button.classList.add('incorrect');
                }
                button.disabled = true;
            });
            
            explanation.innerHTML = "<b>Explanation:</b> " + questions[currentQuestionIndex].explanation;
            explanation.style.display = 'block';
            MathJax.typesetPromise();
        }

        function showResults() {
            let score = 0;
            userAnswers.forEach((answer, index) => {
                if (answer === questions[index].correct) {
                    score++;
                }
            });

            questionContainer.style.display = 'none';
            quizFooter.style.display = 'none';
            resultsContainer.style.display = 'block';
            const scorePercent = Math.round((score / questions.length) * 100);
            scoreText.innerText = `You scored ${score} out of ${questions.length} (${scorePercent}%)`;
        }

        function handleNextButton() {
            if (currentQuestionIndex < questions.length - 1) {
                currentQuestionIndex++;
                showQuestion();
            } else {
                showResults();
            }
        }
        
        function handlePrevButton() {
            if (currentQuestionIndex > 0) {
                currentQuestionIndex--;
                showQuestion();
            }
        }

        nextBtn.addEventListener('click', handleNextButton);
        prevBtn.addEventListener('click', handlePrevButton);
        restartBtn.addEventListener('click', startQuiz);

        startQuiz();
    </script>
</body>
</html>